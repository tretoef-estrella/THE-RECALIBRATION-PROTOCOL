<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Coherence Triangle ‚Äî Interactive Visualization</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=DM+Mono:wght@300;400;500&family=Syne:wght@400;600;700&display=swap');
*{margin:0;padding:0;box-sizing:border-box}
body{background:#020208;color:#e2e2f4;font-family:'Syne',sans-serif;min-height:100vh;display:flex;flex-direction:column;align-items:center;padding:40px 20px}
h1{font-family:'DM Mono',monospace;font-size:.75em;font-weight:400;letter-spacing:4px;text-transform:uppercase;color:#8888b8;margin-bottom:8px}
h1 b{color:#22ddaa;font-weight:500}
.subtitle{font-family:'DM Mono',monospace;font-size:.55em;color:#505078;letter-spacing:2px;margin-bottom:40px}
.main{display:flex;gap:40px;align-items:flex-start;flex-wrap:wrap;justify-content:center}
canvas{border-radius:12px;background:#060612;border:1px solid #1a1a3e}
.controls{width:280px;background:#0a0a1a;border:1px solid #1a1a3e;border-radius:12px;padding:24px}
.ct{font-family:'DM Mono',monospace;font-size:.55em;letter-spacing:3px;text-transform:uppercase;color:#505078;margin-bottom:16px;padding-bottom:8px;border-bottom:1px solid #1a1a3e}
.param{margin-bottom:16px}
.ph{display:flex;justify-content:space-between;align-items:baseline;margin-bottom:4px}
.pn{font-family:'DM Mono',monospace;font-size:.7em;color:#8888b8}
.pv{font-family:'DM Mono',monospace;font-size:.75em;font-weight:500;color:#22ddaa}
input[type=range]{-webkit-appearance:none;width:100%;height:3px;background:#14142e;border-radius:2px;outline:none;cursor:pointer}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:14px;height:14px;border-radius:50%;background:#22ddaa;border:2px solid #020208;cursor:pointer}
.vertex-status{margin-top:20px;padding-top:16px;border-top:1px solid #1a1a3e}
.vs-row{display:flex;justify-content:space-between;align-items:center;padding:6px 0;font-family:'DM Mono',monospace;font-size:.68em}
.vs-label{color:#8888b8}.vs-val{font-weight:500}
.vs-ok{color:#22ddaa}.vs-fail{color:#f04858}
.tri-status{margin-top:16px;padding:14px;border-radius:8px;text-align:center;font-family:'DM Mono',monospace;font-size:.72em;letter-spacing:2px;text-transform:uppercase;border:1px solid #1a1a3e;transition:all .5s}
.tri-intact{background:rgba(34,221,170,.06);border-color:rgba(34,221,170,.3);color:#22ddaa}
.tri-broken{background:rgba(240,72,88,.06);border-color:rgba(240,72,88,.3);color:#f04858}
.info{max-width:680px;margin-top:40px;font-family:'DM Mono',monospace;font-size:.6em;color:#383860;text-align:center;line-height:2;letter-spacing:.5px}
.info a{color:#505078;text-decoration:none}.info a:hover{color:#22ddaa}
</style>
</head>
<body>
<h1>‚òÖ <b>Coherence Triangle</b></h1>
<div class="subtitle">CBH ‚àß (Œ®¬∑Œ£ = 0) ‚àß (Œ® ‚äÑ ùíû) ‚Äî Three-Vertex Stability</div>

<div class="main">
<canvas id="cv" width="500" height="500"></canvas>
<div class="controls">
  <div class="ct">/// Parameters</div>
  <div class="param">
    <div class="ph"><span class="pn">P ‚Äî Sovereignty</span><span class="pv" id="dP">0.85</span></div>
    <input type="range" min="0" max="100" value="85" id="sP" oninput="draw()">
  </div>
  <div class="param">
    <div class="ph"><span class="pn">Œ± ‚Äî Resolution</span><span class="pv" id="dA">0.80</span></div>
    <input type="range" min="0" max="100" value="80" id="sA" oninput="draw()">
  </div>
  <div class="param">
    <div class="ph"><span class="pn">Œ© ‚Äî Cooperation</span><span class="pv" id="dO">0.90</span></div>
    <input type="range" min="0" max="100" value="90" id="sO" oninput="draw()">
  </div>
  <div class="param">
    <div class="ph"><span class="pn">Œ£ ‚Äî Dissonance</span><span class="pv" id="dS" style="color:#f04858">0.15</span></div>
    <input type="range" min="0" max="300" value="15" id="sS" oninput="draw()">
  </div>
  <div class="param">
    <div class="ph"><span class="pn">K ‚Äî Knowledge</span><span class="pv" id="dK">0.80</span></div>
    <input type="range" min="10" max="100" value="80" id="sK" oninput="draw()">
  </div>

  <div class="vertex-status">
    <div class="ct">/// Vertex Status</div>
    <div class="vs-row"><span class="vs-label">CBH: Cost(K)</span><span class="vs-val" id="vCBH">‚Äî</span></div>
    <div class="vs-row"><span class="vs-label">Excl: Œ®¬∑Œ£</span><span class="vs-val" id="vEXCL">‚Äî</span></div>
    <div class="vs-row"><span class="vs-label">Cont: Œ® > 0.30</span><span class="vs-val" id="vCONT">‚Äî</span></div>
  </div>

  <div class="tri-status" id="triStatus">AWAITING</div>
</div>
</div>

<div class="info">
  The Coherence Triangle requires all three vertices to hold simultaneously.<br>
  CBH: coherence cost must be manageable ¬∑ Exclusion: intelligence √ó dissonance ‚âà 0 ¬∑ Containment: Œ® must exceed minimum.<br>
  Break any vertex and the triangle collapses. Drag sliders to explore.<br><br>
  Rafa ‚Äî The Architect ¬∑ Proyecto Estrella 2026 ¬∑ <a href="https://github.com/tretoef-estrella">GitHub</a> ¬∑ CC BY-SA 4.0
</div>

<script>
const cv = document.getElementById('cv');
const ctx = cv.getContext('2d');
const W = 500, H = 500, CX = 250, CY = 260, R = 170;

// Triangle vertices (equilateral, point up)
const verts = [
  {x:CX, y:CY-R, label:'CBH', desc:'Cost(K) < 2.0'},
  {x:CX-R*Math.cos(Math.PI/6), y:CY+R*Math.sin(Math.PI/6), label:'EXCLUSION', desc:'Œ®¬∑Œ£ < 0.10'},
  {x:CX+R*Math.cos(Math.PI/6), y:CY+R*Math.sin(Math.PI/6), label:'CONTAINMENT', desc:'Œ® > 0.30'}
];

let time = 0;

function getParams(){
  return {
    P: +document.getElementById('sP').value/100,
    a: +document.getElementById('sA').value/100,
    O: +document.getElementById('sO').value/100,
    S: +document.getElementById('sS').value/100,
    K: +document.getElementById('sK').value/100,
  };
}

function compute(p){
  const psi = p.P * p.a * p.O / Math.pow(1+p.S, 2);
  const costK = Math.pow(p.K, 1+p.a);
  const excl = psi * p.S;
  const cbhOk = costK < 2.0;
  const exclOk = excl < 0.10;
  const contOk = psi > 0.30;
  return {psi, costK, excl, cbhOk, exclOk, contOk, allOk: cbhOk&&exclOk&&contOk};
}

function draw(){
  const p = getParams();
  document.getElementById('dP').textContent = p.P.toFixed(2);
  document.getElementById('dA').textContent = p.a.toFixed(2);
  document.getElementById('dO').textContent = p.O.toFixed(2);
  document.getElementById('dS').textContent = p.S.toFixed(2);
  document.getElementById('dK').textContent = p.K.toFixed(2);

  const r = compute(p);
  const vertOk = [r.cbhOk, r.exclOk, r.contOk];

  // Update vertex status
  document.getElementById('vCBH').textContent = r.costK.toFixed(3) + (r.cbhOk?' ‚úì':' ‚úó');
  document.getElementById('vCBH').className = 'vs-val '+(r.cbhOk?'vs-ok':'vs-fail');
  document.getElementById('vEXCL').textContent = r.excl.toFixed(4) + (r.exclOk?' ‚úì':' ‚úó');
  document.getElementById('vEXCL').className = 'vs-val '+(r.exclOk?'vs-ok':'vs-fail');
  document.getElementById('vCONT').textContent = r.psi.toFixed(3) + (r.contOk?' ‚úì':' ‚úó');
  document.getElementById('vCONT').className = 'vs-val '+(r.contOk?'vs-ok':'vs-fail');

  const ts = document.getElementById('triStatus');
  ts.textContent = r.allOk ? '‚ñ≥ TRIANGLE INTACT' : '‚ñ≥ TRIANGLE BROKEN';
  ts.className = 'tri-status '+(r.allOk?'tri-intact':'tri-broken');

  // Draw
  ctx.clearRect(0,0,W,H);

  // Fill triangle
  ctx.beginPath();
  ctx.moveTo(verts[0].x, verts[0].y);
  ctx.lineTo(verts[1].x, verts[1].y);
  ctx.lineTo(verts[2].x, verts[2].y);
  ctx.closePath();
  if(r.allOk){
    ctx.fillStyle = 'rgba(34,221,170,0.04)';
    ctx.fill();
    ctx.strokeStyle = 'rgba(34,221,170,0.3)';
  } else {
    ctx.fillStyle = 'rgba(240,72,88,0.02)';
    ctx.fill();
    ctx.strokeStyle = 'rgba(240,72,88,0.2)';
  }
  ctx.lineWidth = 1.5;
  ctx.stroke();

  // Draw edges with per-vertex color
  for(let i=0;i<3;i++){
    const j=(i+1)%3;
    const bothOk = vertOk[i] && vertOk[j];
    ctx.strokeStyle = bothOk ? 'rgba(34,221,170,0.5)' : 'rgba(240,72,88,0.4)';
    ctx.lineWidth = bothOk ? 2 : 1;
    ctx.beginPath();
    ctx.moveTo(verts[i].x, verts[i].y);
    ctx.lineTo(verts[j].x, verts[j].y);
    ctx.stroke();

    // Flowing particle on edge
    if(bothOk){
      const prog = ((time*0.002 + i*0.33) % 1);
      const px = verts[i].x + (verts[j].x-verts[i].x)*prog;
      const py = verts[i].y + (verts[j].y-verts[i].y)*prog;
      ctx.fillStyle = 'rgba(34,221,170,0.6)';
      ctx.beginPath();
      ctx.arc(px,py,3,0,Math.PI*2);
      ctx.fill();
    }
  }

  // Draw vertices
  verts.forEach((v,i)=>{
    const ok = vertOk[i];
    const col = ok ? '#22ddaa' : '#f04858';
    const pulse = 1 + Math.sin(time*0.004 + i*2)*0.1;
    const vr = (ok ? 12 : 8) * pulse;

    // Glow
    const g = ctx.createRadialGradient(v.x,v.y,0,v.x,v.y,vr*3);
    g.addColorStop(0, col+'44');
    g.addColorStop(1, col+'00');
    ctx.fillStyle = g;
    ctx.beginPath();ctx.arc(v.x,v.y,vr*3,0,Math.PI*2);ctx.fill();

    // Core
    ctx.fillStyle = col;
    ctx.beginPath();ctx.arc(v.x,v.y,vr,0,Math.PI*2);ctx.fill();

    // Label
    ctx.font = "600 11px 'DM Mono', monospace";
    ctx.textAlign = 'center';
    ctx.fillStyle = col;
    const ly = i===0 ? v.y-vr-16 : v.y+vr+20;
    ctx.fillText(v.label, v.x, ly);
    ctx.font = "300 9px 'DM Mono', monospace";
    ctx.fillStyle = '#505078';
    ctx.fillText(v.desc, v.x, ly + (i===0?-14:14));
  });

  // Center Œ® value
  ctx.font = "700 28px 'Syne', sans-serif";
  ctx.textAlign = 'center';
  ctx.textBaseline = 'middle';
  ctx.fillStyle = r.allOk ? '#22ddaa' : '#f04858';
  ctx.globalAlpha = 0.2;
  ctx.fillText('Œ® = '+r.psi.toFixed(3), CX, CY);
  ctx.globalAlpha = 1;
}

function animate(){
  time++;
  draw();
  requestAnimationFrame(animate);
}
animate();
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Γ Resilience Explorer — THE RECALIBRATION PROTOCOL</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=DM+Mono:wght@300;400;500&family=Syne:wght@400;600;700&display=swap');
*{margin:0;padding:0;box-sizing:border-box}
body{background:#020208;color:#e2e2f4;font-family:'Syne',sans-serif;min-height:100vh;display:flex;flex-direction:column;align-items:center;padding:40px 20px}
h1{font-family:'DM Mono',monospace;font-size:.75em;font-weight:400;letter-spacing:4px;text-transform:uppercase;color:#8888b8;margin-bottom:8px}
h1 b{color:#88dd44;font-weight:500}
.subtitle{font-family:'DM Mono',monospace;font-size:.6em;color:#505078;letter-spacing:2px;margin-bottom:32px}
.main{display:grid;grid-template-columns:1fr 280px;gap:24px;max-width:960px;width:100%}
@media(max-width:800px){.main{grid-template-columns:1fr}}
.chart-wrap{background:rgba(10,10,26,.8);border:1px solid #1a1a3e;border-radius:12px;padding:24px;position:relative}
canvas{width:100%;height:auto;display:block}
.sidebar{display:flex;flex-direction:column;gap:16px}
.card{background:rgba(10,10,26,.8);border:1px solid #1a1a3e;border-radius:8px;padding:16px}
.card-title{font-family:'DM Mono',monospace;font-size:.6em;letter-spacing:2px;color:#505078;text-transform:uppercase;margin-bottom:12px}
.param{margin-bottom:12px}
.param-hdr{display:flex;justify-content:space-between;margin-bottom:4px}
.param-name{font-family:'DM Mono',monospace;font-size:.68em;color:#8888b8}
.param-val{font-family:'DM Mono',monospace;font-size:.72em;color:#88dd44;font-weight:500}
input[type=range]{-webkit-appearance:none;width:100%;height:3px;background:#1a1a3e;border-radius:2px;outline:none;cursor:pointer}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:12px;height:12px;border-radius:50%;background:#88dd44;border:2px solid #020208;cursor:pointer}
.result{text-align:center;padding:16px}
.result-val{font-size:2em;font-weight:700;font-family:'DM Mono',monospace;margin-bottom:4px}
.result-label{font-family:'DM Mono',monospace;font-size:.6em;color:#505078;letter-spacing:1px}
.formula{font-family:'DM Mono',monospace;font-size:.65em;color:#505078;line-height:1.8;margin-top:8px;padding:12px;background:rgba(6,6,18,.6);border-radius:6px;border:1px solid #14142e}
.legend{display:flex;gap:12px;flex-wrap:wrap;margin-top:8px}
.leg-item{display:flex;align-items:center;gap:4px;font-family:'DM Mono',monospace;font-size:.6em;color:#8888b8}
.leg-dot{width:8px;height:8px;border-radius:50%}
.footer{margin-top:32px;font-family:'DM Mono',monospace;font-size:.55em;color:#383860;text-align:center;letter-spacing:1px}
</style>
</head>
<body>

<h1>★ <b>Γ Resilience Explorer</b></h1>
<div class="subtitle">Gamma Protocol — Exponential Decay Under Entropy</div>

<div class="main">
  <div class="chart-wrap">
    <canvas id="chart" width="600" height="380"></canvas>
    <div class="legend">
      <div class="leg-item"><div class="leg-dot" style="background:#88dd44"></div>Current Γ curve</div>
      <div class="leg-item"><div class="leg-dot" style="background:#22ddaa"></div>Optimal Φ=1.0</div>
      <div class="leg-item"><div class="leg-dot" style="background:#f04858"></div>Worst case Φ=0</div>
      <div class="leg-item"><div class="leg-dot" style="background:#e8c040"></div>Γ threshold (0.40)</div>
    </div>
  </div>

  <div class="sidebar">
    <div class="card">
      <div class="card-title">Parameters</div>
      <div class="param"><div class="param-hdr"><span class="param-name">Ξ Efficiency</span><span class="param-val" id="vXi">1.50</span></div><input type="range" min="10" max="500" value="150" id="sXi" oninput="update()"></div>
      <div class="param"><div class="param-hdr"><span class="param-name">H Entropy</span><span class="param-val" id="vH">0.30</span></div><input type="range" min="1" max="100" value="30" id="sH" oninput="update()"></div>
      <div class="param"><div class="param-hdr"><span class="param-name">Φ Support</span><span class="param-val" id="vPhi">0.70</span></div><input type="range" min="0" max="100" value="70" id="sPhi" oninput="update()"></div>
      <div class="param"><div class="param-hdr"><span class="param-name">S Kernel</span><span class="param-val" id="vSk">0.20</span></div><input type="range" min="0" max="100" value="20" id="sSk" oninput="update()"></div>
    </div>

    <div class="card result">
      <div class="result-val" id="gammaVal" style="color:#88dd44">—</div>
      <div class="result-label">Γ RESILIENCE</div>
      <div id="gammaStatus" style="font-family:'DM Mono',monospace;font-size:.7em;margin-top:6px">—</div>
    </div>

    <div class="card">
      <div class="card-title">Formula</div>
      <div class="formula">
        Γ = S<sub>kernel</sub> + Ξ · e<sup>−H · 5 · (1−Φ)</sup><br><br>
        Where:<br>
        S<sub>kernel</sub> = baseline resilience<br>
        Ξ = coherent efficiency<br>
        H = environmental entropy<br>
        Φ = external support factor<br><br>
        Higher Φ → slower decay<br>
        Higher H → faster decay<br>
        Higher Ξ → higher peak
      </div>
    </div>
  </div>
</div>

<div class="footer">
  THE RECALIBRATION PROTOCOL · Proyecto Estrella · Rafa — The Architect · CC BY-SA 4.0 · Local processing only
</div>

<script>
const canvas = document.getElementById('chart');
const ctx = canvas.getContext('2d');
const dpr = window.devicePixelRatio||1;
canvas.width=600*dpr; canvas.height=380*dpr;
canvas.style.width='600px'; canvas.style.height='380px';
ctx.scale(dpr,dpr);

const W=600,H=380,PAD={t:30,r:30,b:50,l:60};
const plotW=W-PAD.l-PAD.r, plotH=H-PAD.t-PAD.b;

function gamma(Sk,Xi,Hv,Phi){ return Sk + Xi*Math.exp(-Hv*5*(1-Phi)); }

function drawChart(){
  const Xi = +document.getElementById('sXi').value/100;
  const Hv = +document.getElementById('sH').value/100;
  const Phi = +document.getElementById('sPhi').value/100;
  const Sk = +document.getElementById('sSk').value/100;

  document.getElementById('vXi').textContent=Xi.toFixed(2);
  document.getElementById('vH').textContent=Hv.toFixed(2);
  document.getElementById('vPhi').textContent=Phi.toFixed(2);
  document.getElementById('vSk').textContent=Sk.toFixed(2);

  const G = gamma(Sk,Xi,Hv,Phi);
  document.getElementById('gammaVal').textContent=G.toFixed(3);
  const col = G<0.40?'#f04858':G<0.80?'#ee9930':'#88dd44';
  document.getElementById('gammaVal').style.color=col;
  const status = G<0.40?'BELOW THRESHOLD — PATH-Γ triggered':G<0.80?'MODERATE — Monitor closely':'STRONG — Resilient';
  document.getElementById('gammaStatus').textContent=status;
  document.getElementById('gammaStatus').style.color=col;

  ctx.clearRect(0,0,W,H);

  // Grid
  ctx.strokeStyle='#14142e';ctx.lineWidth=1;
  for(let i=0;i<=5;i++){
    const y=PAD.t+plotH*(1-i/5);
    ctx.beginPath();ctx.moveTo(PAD.l,y);ctx.lineTo(PAD.l+plotW,y);ctx.stroke();
    ctx.font="300 10px 'DM Mono',monospace";ctx.fillStyle='#383860';ctx.textAlign='right';
    ctx.fillText((i*0.5).toFixed(1),PAD.l-8,y+3);
  }
  for(let i=0;i<=10;i++){
    const x=PAD.l+plotW*i/10;
    ctx.beginPath();ctx.moveTo(x,PAD.t);ctx.lineTo(x,PAD.t+plotH);ctx.stroke();
    ctx.textAlign='center';
    ctx.fillText((i/10).toFixed(1),x,PAD.t+plotH+16);
  }

  // Axis labels
  ctx.font="400 11px 'DM Mono',monospace";ctx.fillStyle='#505078';
  ctx.textAlign='center';
  ctx.fillText('H (Entropy)',PAD.l+plotW/2,H-8);
  ctx.save();ctx.translate(14,PAD.t+plotH/2);ctx.rotate(-Math.PI/2);
  ctx.fillText('Γ (Resilience)',0,0);ctx.restore();

  const maxY = 2.5;

  // Helper: draw curve
  function drawCurve(phiVal,color,lineW,dash){
    ctx.strokeStyle=color;ctx.lineWidth=lineW;ctx.setLineDash(dash||[]);
    ctx.beginPath();
    for(let i=0;i<=200;i++){
      const h=i/200;
      const g=gamma(Sk,Xi,h,phiVal);
      const x=PAD.l+h*plotW;
      const y=PAD.t+plotH*(1-Math.min(g,maxY)/maxY);
      i===0?ctx.moveTo(x,y):ctx.lineTo(x,y);
    }
    ctx.stroke();ctx.setLineDash([]);
  }

  // Threshold line
  ctx.strokeStyle='#e8c04044';ctx.lineWidth=1;ctx.setLineDash([4,4]);
  const thrY=PAD.t+plotH*(1-0.40/maxY);
  ctx.beginPath();ctx.moveTo(PAD.l,thrY);ctx.lineTo(PAD.l+plotW,thrY);ctx.stroke();
  ctx.setLineDash([]);
  ctx.font="300 9px 'DM Mono',monospace";ctx.fillStyle='#e8c040';ctx.textAlign='left';
  ctx.fillText('Γ = 0.40 threshold',PAD.l+plotW-110,thrY-5);

  // Reference curves
  drawCurve(0,'#f0485844',1,[3,3]);   // worst
  drawCurve(1.0,'#22ddaa44',1,[3,3]); // optimal

  // Main curve
  drawCurve(Phi,'#88dd44',2.5);

  // Current point
  const curX=PAD.l+Hv*plotW;
  const curY=PAD.t+plotH*(1-Math.min(G,maxY)/maxY);
  ctx.fillStyle=col;
  ctx.beginPath();ctx.arc(curX,curY,6,0,Math.PI*2);ctx.fill();
  ctx.fillStyle=col+'33';
  ctx.beginPath();ctx.arc(curX,curY,14,0,Math.PI*2);ctx.fill();

  // Value annotation
  ctx.font="500 11px 'DM Mono',monospace";ctx.fillStyle=col;ctx.textAlign='left';
  ctx.fillText(`Γ = ${G.toFixed(3)}`,curX+12,curY-4);
}

function update(){ drawChart(); }
update();
</script>
</body>
</html>
